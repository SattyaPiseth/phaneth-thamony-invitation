{
  "version": 2,
  "routes": [
    { "src": "^/(assets/.+)$", "headers": { "Cache-Control": "public, max-age=31536000, immutable" }, "dest": "/$1" },
    { "src": "^/(images/.+)$", "headers": { "Cache-Control": "public, max-age=31536000, immutable" }, "dest": "/$1" },
    { "src": "^/(audio/.+)$",  "headers": { "Cache-Control": "public, max-age=31536000, immutable" }, "dest": "/$1" },

    { "src": "^/(fonts/.+\\.woff2)$", "headers": { "Cache-Control": "public, max-age=31536000, immutable", "Content-Type": "font/woff2" }, "dest": "/$1" },
    { "src": "^/(fonts/.+)$",         "headers": { "Cache-Control": "public, max-age=31536000, immutable" }, "dest": "/$1" },
    {
      "src": "^/(videos/.+)$",
      "headers": { "Cache-Control": "public, max-age=31536000, immutable", "Accept-Ranges": "bytes" },
      "dest": "/$1"
    },

    {
      "src": "^/api/.*$",
      "headers": {
        "Cache-Control": "no-store, no-cache, must-revalidate",
        "Vercel-CDN-Cache-Control": "max-age=0, s-maxage=0, stale-while-revalidate=0"
      },
      "continue": true
    },
    { "src": "^/api/wishes/?$", "dest": "api/wishes.js" },

    {
      "src": "^/$",
      "has": [
        {
          "type": "header",
          "key": "user-agent",
          "value": "(?i)(Twitterbot|facebookexternalhit|LinkedInBot|Slackbot|WhatsApp|TelegramBot|Pinterest|Discordbot|Google-InspectionTool|Googlebot|Bingbot|DuckDuckBot)"
        }
      ],
      "dest": "/api/ssr-meta",
      "headers": {
        "Cache-Control": "no-cache",
        "Vercel-CDN-Cache-Control": "s-maxage=600, stale-while-revalidate=300"
      }
    },
    {
      "src": "^/([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12})$",
      "has": [
        {
          "type": "header",
          "key": "user-agent",
          "value": "(?i)(Twitterbot|facebookexternalhit|LinkedInBot|Slackbot|WhatsApp|TelegramBot|Pinterest|Discordbot|Google-InspectionTool|Googlebot|Bingbot|DuckDuckBot)"
        }
      ],
      "dest": "/api/ssr-meta",
      "headers": {
        "Cache-Control": "no-cache",
        "Vercel-CDN-Cache-Control": "s-maxage=600, stale-while-revalidate=300"
      }
    },

    {
      "src": "^(?!/(?:assets|images|audio|videos|api)/).*$",
      "headers": {
        "Cache-Control": "no-cache",
        "Vercel-CDN-Cache-Control": "s-maxage=600, stale-while-revalidate=300",
        "Vary": "User-Agent"
      },
      "dest": "/index.html"
    }
  ]
}
